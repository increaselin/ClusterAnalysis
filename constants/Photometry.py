#! /usr/bin/env python
# 
# Module: Photometry.py
#
# Author: Mike Lum
#
# Description: Constants and reference tables to support 
# photometric parameter calculations.
#
# Revision History:
#    Date        Vers.    Author        Description
#    07/21/17    1.0f1    Lum        Adding constants for Huang et al. 2015
#    11/01/15    0.0a0    Lum        First checked in
#
# To Do:
#    
#
# References:
#
# 
# Huang, Y.; Liu, X.-W.; Yuan, H.-B.; Xiang, M.-S.; Chen, B.-Q.; Zhang, H.-W.;
#   "Empirical metallicity-dependent calibrations of effective temperature against colours for dwarfs and giants based on interferometric data"
#    MNRAS; v454, I3, pp.2863-2889; December 2015

# These are the textual names of the potential filters
FilterDict = {'B':'B (Johnson/Cousins)','V':'V (Johnson/Cousins)','R':'R (Cousins)','I':'I (Cousins)','J':'J (2MASS)','H':'H (2MASS)','K':'K (2MASS)','BT':'B (Tycho)','VT':'V (Tycho)','b':'b (Stromgren)','y':'y (Stromgren)', 'VV':'V (Vilnius)', 'YV':'Y (Vilnius)', 'SV':'S (Vilnius)', 'BG':'B (Geneva)', 'GG':'G (Geneva)', 'VG':'V (Geneva)', 'U':'U (Johnson)', 'RJ':'R (Johnson)', 'IJ':'I (Johnson)', 'JJ':'J (Johnson)', 'HJ':'H (Johnson)', 'KJ':'K (Johnson)', 'gS':'g (SDSS)', 'rS':'r (SDSS)'}

# Table 3 from Huang et al. 2015 (for Dwarfs)
HuangFGKDwarfTable3 = {\
'UJmV' :{'a0':0.68567, 'a1':0.25708, 'a2':-0.02644, 'a3':-0.03637, 'a4':-0.09993, 'a5':-0.03003, 'sigmaPct':1.73},\
'BmV'  :{'a0':0.63421, 'a1':0.30538, 'a2': 0.12308, 'a3':-0.06216, 'a4':-0.01987, 'a5':-0.00951, 'sigmaPct':1.96},\
'VmRJ' :{'a0':0.50741, 'a1':0.74628, 'a2':-0.10012, 'a3':-0.05966, 'a4':-0.00411, 'a5':-0.00297, 'sigmaPct':2.64},\
'RJmIJ':{'a0':0.52917, 'a1':1.18647, 'a2':-0.38691, 'a3':-0.14505, 'a4': 0.05246, 'a5': 0.00312, 'sigmaPct':2.73},\
'VmIJ' :{'a0':0.50673, 'a1':0.47658, 'a2':-0.05391, 'a3':-0.04491, 'a4': 0.01236, 'a5':-0.00734, 'sigmaPct':2.43},\
'VmR'  :{'a0':0.57684, 'a1':0.87545, 'a2':-0.07718, 'a3':-0.22472, 'a4': 0.06639, 'a5':-0.00347, 'sigmaPct':2.35},\
'RmI'  :{'a0':0.52327, 'a1':1.22375, 'a2':-0.39607, 'a3':-0.30792, 'a4': 0.08613, 'a5':-0.01724, 'sigmaPct':2.69},\
'VmI'  :{'a0':0.53066, 'a1':0.56556, 'a2':-0.07742, 'a3':-0.13244, 'a4': 0.07752, 'a5':-0.00969, 'sigmaPct':2.38},\
'VmJJ' :{'a0':0.51683, 'a1':0.36567, 'a2':-0.03065, 'a3':-0.05507, 'a4': 0.06928, 'a5':-0.00047, 'sigmaPct':2.08},\
'VmHJ' :{'a0':0.57826, 'a1':0.22238, 'a2':-0.00473, 'a3':-0.07342, 'a4': 0.13820, 'a5': 0.01264, 'sigmaPct':2.00},\
'VmKJ' :{'a0':0.56784, 'a1':0.22038, 'a2':-0.00585, 'a3':-0.06218, 'a4': 0.10765, 'a5': 0.00651, 'sigmaPct':1.87},\
'gSmrS':{'a0':0.70726, 'a1':0.33962, 'a2': 0.13127, 'a3':-0.04405, 'a4':-0.03616, 'a5':-0.00935, 'sigmaPct':1.86},\
'gSmJJ':{'a0':0.56499, 'a1':0.24982, 'a2':-0.01194, 'a3':-0.03654, 'a4': 0.03880, 'a5':-0.00298, 'sigmaPct':1.88},\
'gSmHJ':{'a0':0.60421, 'a1':0.16755, 'a2':-0.00064, 'a3':-0.05271, 'a4': 0.10246, 'a5': 0.00965, 'sigmaPct':1.93},\
'gSmKJ':{'a0':0.59712, 'a1':0.16510, 'a2':-0.00123, 'a3':-0.04565, 'a4': 0.07963, 'a5': 0.00481, 'sigmaPct':1.76},\
'VmJ'  :{'a0':0.49543, 'a1':0.36971, 'a2':-0.03068, 'a3':-0.05506, 'a4': 0.07191, 'a5':-0.00066, 'sigmaPct':2.07},\
'VmH'  :{'a0':0.57565, 'a1':0.22418, 'a2':-0.00501, 'a3':-0.07282, 'a4': 0.13574, 'a5': 0.01211, 'sigmaPct':1.95},\
'VmK'  :{'a0':0.55470, 'a1':0.22536, 'a2':-0.00647, 'a3':-0.06318, 'a4': 0.11273, 'a5': 0.00697, 'sigmaPct':1.88},\
'gSmJ' :{'a0':0.55158, 'a1':0.25030, 'a2':-0.01172, 'a3':-0.03662, 'a4': 0.04096, 'a5':-0.00296, 'sigmaPct':1.87},\
'gSmH' :{'a0':0.60082, 'a1':0.16907, 'a2':-0.00078, 'a3':-0.04698, 'a4': 0.07517, 'a5': 0.00001, 'sigmaPct':1.77},\
'gSmK' :{'a0':0.58681, 'a1':0.16856, 'a2':-0.00163, 'a3':-0.04666, 'a4': 0.08483, 'a5': 0.00564, 'sigmaPct':1.79}\
}

HuangFGKDwarfRanges = {\
'UJmV' :[[(-0.8, 0.4),(+0.16, 2.58)]],\
'BmV'  :[[(-0.9, 0.4),(+0.32, 1.73)]],\
'VmRJ' :[[(-0.9, 0.4),(+0.32, 1.69)]],\
'RJmIJ':[[(-0.9, 0.4),(+0.18, 1.43)]],\
'VmIJ' :[[(-0.9, 0.4),(+0.51, 3.12)]],\
'VmR'  :[[(-0.8, 0.2),(+0.22, 1.21)]],\
'RmI'  :[[(-0.8, 0.2),(+0.22, 1.56)]],\
'VmIC' :[[(-0.8, 0.2),(+0.44, 2.77)]],\
'VmJJ' :[[(-0.9, 0.4),(+0.60, 4.24)]],\
'VmHJ' :[[(-0.9, 0.4),(+0.67, 4.76)]],\
'VmKJ' :[[(-0.9, 0.4),(+0.82, 5.03)]],\
'gSmrS':[[(-0.9, 0.4),(+0.10, 1.53)]],\
'gSmJJ':[[(-0.9, 0.4),(+0.67, 5.15)]],\
'gSmHJ':[[(-0.9, 0.4),(+0.75, 5.68)]],\
'gSmKJ':[[(-0.9, 0.4),(+0.89, 5.95)]],\
'VmJ'  :[[(-0.9, 0.4),(+0.66, 4.28)]],\
'VmH'  :[[(-0.9, 0.4),(+0.69, 4.77)]],\
'VmK'  :[[(-0.9, 0.4),(+0.86, 5.05)]],\
'gSmJ' :[[(-0.9, 0.4),(+0.73, 5.19)]],\
'gSmH' :[[(-0.9, 0.4),(+0.77, 5.68)]],\
'gSmK' :[[(-0.9, 0.4),(+0.94, 5.96)]]\
}

HuangAFGKDwarfTable3={\

}

HuangAFGKDwarfRanges = {\
'UJmV' :[[(-0.8, 0.4),(+0.11, 2.58)]],\
'BmV'  :[[(-0.9, 0.4),(-0.05, 1.73)]],\
'VmRJ' :[[(-0.9, 0.4),(-0.04, 1.69)]],\
'RJmIJ':[[(-0.9, 0.4),(-0.03, 1.43)]],\
'VmIJ' :[[(-0.9, 0.4),(-0.07, 3.12)]],\
'VmR'  :[[(-0.8, 0.2),(-0.05, 1.21)]],\
'RmI'  :[[(-0.8, 0.2),(-0.01, 1.56)]],\
'VmIC' :[[(-0.8, 0.2),(-0.06, 2.77)]],\
'VmJJ' :[[(-0.9, 0.4),(-0.12, 4.24)]],\
'VmHJ' :[[(-0.9, 0.4),(-0.13, 4.76)]],\
'VmKJ' :[[(-0.9, 0.4),(-0.15, 5.03)]],\
'gSmrS':[[(-0.9, 0.4),(-0.28, 1.53)]],\
'gSmJJ':[[(-0.9, 0.4),(-0.24, 5.15)]],\
'gSmHJ':[[(-0.9, 0.4),(-0.25, 5.68)]],\
'gSmKJ':[[(-0.9, 0.4),(-0.27, 5.95)]],\
'VmJ'  :[[(-0.9, 0.4),(-0.06, 4.28)]],\
'VmH'  :[[(-0.9, 0.4),(-0.13, 4.77)]],\
'VmK'  :[[(-0.9, 0.4),(-0.10, 5.05)]],\
'gSmJ' :[[(-0.9, 0.4),(-0.18, 5.19)]],\
'gSmH' :[[(-0.9, 0.4),(-0.25, 5.68)]],\
'gSmK' :[[(-0.9, 0.4),(-0.22, 5.96)]]\
}

HuangGiantTable4={\
'UJmV'  :{'a0':0.85926,'a1':0.06128,'a2': 0.02054,'a3': 0.00341,'a4':-0.04250,'a5': 0.08760, 'sigmaPct':1.55},\
'BmV'   :{'a0':0.81784,'a1':0.03096,'a2': 0.19350,'a3':-0.03292,'a4': 0.00762,'a5': 0.11140, 'sigmaPct':1.86},\
'VmRJ'  :{'a0':0.50982,'a1':0.86731,'a2':-0.16385,'a3': 0.00099,'a4':-0.05206,'a5':-0.03531, 'sigmaPct':2.14},\
'RmIJ'  :{'a0':0.58534,'a1':1.07395,'a2':-0.30028,'a3': 0.08547,'a4':-0.07481,'a5': 0.10417, 'sigmaPct':2.34},\
'VmIJ'  :{'a0':0.51361,'a1':0.51406,'a2':-0.06282,'a3': 0.03408,'a4':-0.09130,'a5': 0.01118, 'sigmaPct':1.96},\
'VmJJ'  :{'a0':0.46448,'a1':0.42236,'a2':-0.03986,'a3':-0.01037,'a4': 0.00000,'a5':-0.06615, 'sigmaPct':1.92},\
'VmHJ'  :{'a0':0.42078,'a1':0.33924,'a2':-0.02323,'a3':-0.04718,'a4': 0.11736,'a5':-0.05597, 'sigmaPct':0.93},\
'VmKJ'  :{'a0':0.47934,'a1':0.29738,'a2':-0.01888,'a3':-0.02526,'a4': 0.06059,'a5':-0.04110, 'sigmaPct':1.68},\
'gSmrS' :{'a0':0.82134,'a1':0.14378,'a2': 0.17360,'a3':-0.02994,'a4':-0.00477,'a5': 0.10091, 'sigmaPct':1.88},\
'gSmJJ' :{'a0':0.49851,'a1':0.30054,'a2':-0.01921,'a3':-0.01956,'a4': 0.02561,'a5':-0.04232, 'sigmaPct':1.72},\
'gSmHJ' :{'a0':0.46461,'a1':0.25124,'a2':-0.01189,'a3':-0.03594,'a4': 0.09960,'a5':-0.03641, 'sigmaPct':0.93},\
'gSmKJ' :{'a0':0.51612,'a1':0.22256,'a2':-0.00966,'a3':-0.01988,'a4': 0.04938,'a5':-0.03274, 'sigmaPct':1.59},\
'VmJ'   :{'a0':0.44863,'a1':0.41980,'a2':-0.03858,'a3':-0.02540,'a4': 0.03704,'a5':-0.05304, 'sigmaPct':1.90},\
'VmH'   :{'a0':0.42367,'a1':0.33746,'a2':-0.02298,'a3':-0.04768,'a4': 0.11713,'a5':-0.05342, 'sigmaPct':0.92},\
'VmK'   :{'a0':0.46447,'a1':0.30156,'a2':-0.01918,'a3':-0.02526,'a4': 0.06132,'a5':-0.04036, 'sigmaPct':1.68},\
'gSmJ'  :{'a0':0.47230,'a1':0.30872,'a2':-0.02003,'a3':-0.01081,'a4':-0.00000,'a5':-0.05341, 'sigmaPct':1.72},\
'gSmH'  :{'a0':0.46683,'a1':0.25008,'a2':-0.01175,'a3':-0.03545,'a4': 0.09634,'a5':-0.03581, 'sigmaPct':0.93},\
'gSmK'  :{'a0':0.50481,'a1':0.22511,'a2':-0.00980,'a3':-0.01982,'a4': 0.04878,'a5':-0.03720, 'sigmaPct':1.59}\
}

HuangGiantRanges={\
'UJmV' :[[(-0.6, 0.3),(1.53, 3.55)]],\
'BmV'  :[[(-0.6, 0.3),(0.88, 1.59)]],\
'VmRJ' :[[(-0.6, 0.3),(0.61, 2.05)]],\
'RmIJ' :[[(-0.6, 0.3),(0.45, 1.91)]],\
'VmIJ' :[[(-0.6, 0.3),(1.06, 3.96)]],\
'VmJJ' :[[(-0.6, 0.3),(1.45, 4.90)]],\
'VmHJ' :[[(-0.6, 0.3),(1.95, 5.80)]],\
'VmKJ' :[[(-0.6, 0.3),(1.96, 6.08)]],\
'gSmrS':[[(-0.6, 0.3),(0.66, 1.39)]],\
'gSmJJ':[[(-0.6, 0.3),(1.81, 5.73)]],\
'gSmHJ':[[(-0.6, 0.3),(2.31, 6.63)]],\
'gSmKJ':[[(-0.6, 0.3),(2.32, 6.91)]],\
'VmJ'  :[[(-0.6, 0.3),(1.51, 4.95)]],\
'VmH'  :[[(-0.6, 0.3),(1.94, 5.79)]],\
'VmK'  :[[(-0.6, 0.3),(1.99, 6.09)]],\
'gSmJ' :[[(-0.6, 0.3),(1.87, 5.78)]],\
'gSmH' :[[(-0.6, 0.3),(2.30, 6.63)]],\
'gSmK' :[[(-0.6, 0.3),(2.35, 6.92)]]\
}
# Table 4 from Casagrande 2010 contains the polynomial values for the 
# calculation. 
#    Key:
#        B,V,R,I     : Johnson-Cousins
#        J,H,K        : 2MASS
#        B_T, V_T    : Tycho2
#        b,y        : Stromgren
CasagrandeTable4 = {\
    'BmV':{'a0':0.5665,'a1':0.4809,'a2':-0.0060,'a3':-0.0613,'a4':-0.0042,'a5':-0.0055,'sigma':73},\
    'VmR':{'a0':0.4386,'a1':1.4614,'a2':-0.7014,'a3':-0.0807,'a4':0.0142,'a5':-0.0015,'sigma':62},\
    'RmI':{'a0':0.3296,'a1':1.9716,'a2':-1.0225,'a3':-0.0298,'a4':0.0329,'a5':0.0035,'sigma':82},\
    'VmI':{'a0':0.4033,'a1':0.8171,'a2':-0.1987,'a3':-0.0409,'a4':0.0319,'a5':0.0012,'sigma':59},\
    'VmJ':{'a0':0.4669,'a1':0.3849,'a2':-0.0350,'a3':-0.0140,'a4':0.0225,'a5':0.0011,'sigma':42},\
#    'YVmVV':{'a0':0.0644,'a1':1.7517,'a2':-0.5264,'a3':-0.0044,'a4':-0.0407,'a5':-0.0132,'sigma':121},\
#    'VVmSV':{'a0':0.2417,'a1':1.3653,'a2':-0.3823,'a3':-0.0387,'a4':-0.0105,'a5':-0.0077,'sigma':95},\
    'VmH':{'a0':0.5251,'a1':0.2553,'a2':-0.0119,'a3':-0.0187,'a4':0.0410,'a5':0.0025,'sigma':33},\
    'VmK':{'a0':0.5057,'a1':0.2600,'a2':-0.0146,'a3':-0.0131,'a4':0.0288,'a5':0.0016,'sigma':25},\
    'JmK':{'a0':0.6393,'a1':0.6104,'a2':0.0920,'a3':-0.0330,'a4':0.0291,'a5':0.0020,'sigma':132},\
    'BTmVT':{'a0':0.5839,'a1':0.4000,'a2':-0.0067,'a3':-0.0282,'a4':-0.0346,'a5':-0.0087,'sigma':79},\
    'VTmJ':{'a0':0.4525,'a1':0.3797,'a2':-0.0357,'a3':-0.0082,'a4':0.0123,'a5':-0.0009,'sigma':43},\
    'VTmH':{'a0':0.5286,'a1':0.2354,'a2':-0.0073,'a3':-0.0182,'a4':0.0401,'a5':0.0021,'sigma':26},\
    'VTmK':{'a0':0.4892,'a1':0.2634,'a2':-0.0165,'a3':-0.0121,'a4':0.0249,'a5':-0.0001,'sigma':18},\
    'bmy':{'a0':0.5796,'a1':0.4812,'a2':0.5747,'a3':-0.0633,'a4':0.0042,'a5':-0.0055,'sigma':62}}

# The polynomial maps are only valid for a specific range of metallicities (and photometries).
CasagrandeRanges = {\
    'BmV':[[(-5.0,0.4),(0.18,1.29)]],\
    'VmR':[[(-5.0,0.3),(0.24, 0.80)]],\
    'RmI':[[(-5.0, 0.3),(0.23, 0.68)]],\
    'VmI':[[(-5.0, 0.3),(0.46, 1.47)]],\
    'VmJ':[[(-5.0, 0.4),(0.61, 2.44)]],\
    'VmH':[[(-5.0, 0.4),(0.67, 3.01)]],\
    'VmK':[[(-5.0, 0.4),(0.78, 3.15)]],\
    'JmK':[[(-5.0, 0.4),(0.07, 0.80)]],\
    'BTmVT':[[(-2.7, 0.4),(0.19, 1.49)]],\
    'VTmJ':[[(-2.7, 0.4),(0.77, 2.56)]],\
    'VTmH':[[(-2.7, 0.4),(0.77, 3.16)]],\
    'VTmK':[[(-2.7, 0.4),(0.99, 3.29)]],\
    'bmy':[[(-3.7, 0.5),(0.18, 0.72)]]}

# Ramirez and Melendez 2005 has the original polynomial coefficients which
# were refined in Casagrande 2010. They also had coefficients for giant
# atmosphere calculations, which were not refined in Casagrande 2010.
#
#    Photometry Key:
#        B,V,R,I      : Johnson-Cousins
#        J,H,K        : 2MASS
#        BT, VT       : Tycho2
#        VV, YV,      : Vilnius
#           SV
#        BG, GG,      : Geneva
#         VG, t
#        b,y          : Stromgren
# Unused:
# t 0.7460 0.8151 -0.1943 0.0855 -0.0421 -0.0034 44
# C(42 - 45) 0.4783 0.7748 -0.1361 -0.0712 -0.0117 0.0071 57
# C(42 - 48) 0.0023 0.6401 -0.0632 -0.0023 -0.0706 -0.0070 49
#
# Note: Table 2 is for dwarfs, table 3 for giants

RamMelTable2 = {\
    'BmV':{'a0':0.5002,'a1':0.6440,'a2':-0.0690,'a3':-0.0230,'a4':-0.0566,'a5':-0.0170,'sigma':88},\
    'bmy':{'a0':0.4129,'a1':1.2570,'a2':-0.2268,'a3':-0.0242,'a4':-0.0464,'a5':-0.0200,'sigma':87},\
    'YVmVV':{'a0':0.0644,'a1':1.7517,'a2':-0.5264,'a3':-0.0044,'a4':-0.0407,'a5':-0.0132,'sigma':121},\
    'VVmSV':{'a0':0.2417,'a1':1.3653,'a2':-0.3823,'a3':-0.0387,'a4':-0.0105,'a5':-0.0077,'sigma':95},\
    'BGmVG':{'a0':0.6019,'a1':0.7663,'a2':-0.0713,'a3':-0.0339,'a4':-0.0382,'a5':-0.0137,'sigma':74},\
    'BGmGG':{'a0': 0.8399,'a1':0.4909,'a2':-0.0666,'a3':-0.0360,'a4':-0.0468,'a5':-0.0124,'sigma':66},\
    'VmR':{'a0':0.4333,'a1':1.4399,'a2':-0.5419,'a3':-0.0481,'a4':-0.0239,'a5':-0.0125,'sigma':84},\
    'VmI':{'a0':0.3295,'a1':0.9516,'a2':-0.2290,'a3':-0.0316,'a4':0.0003,'a5':-0.0081,'sigma':68},\
    'RmI':{'a0':0.2919,'a1':2.1141,'a2':-1.0723,'a3':-0.0756,'a4':0.0267,'a5':-0.0041,'sigma':76},\
    'BTmVT':{'a0':0.5619,'a1':0.4462,'a2':-0.0029,'a3':0.0003,'a4':-0.0746,'a5':-0.0190,'sigma':104},\
    'VmJ':{'a0':0.4050,'a1':0.4792,'a2':-0.0617,'a3':-0.0392,'a4':0.0401,'a5':-0.0023,'sigma':62},\
    'VmH':{'a0':0.4931,'a1':0.3056,'a2':-0.0241,'a3':-0.0396,'a4':0.0678,'a5':0.0020,'sigma':57},\
    'VmK':{'a0':0.4942,'a1':0.2809,'a2':-0.0180,'a3':-0.0294,'a4':0.0444,'a5':-0.0008,'sigma':50},\
    'VTmK':{'a0':0.4886,'a1':0.2773,'a2':-0.0195,'a3':-0.0300,'a4':0.0467,'a5':-0.0008,'sigma':59}}


RamMelTable3 = {\
    'BmV':{'a0':0.5737,'a1':0.4882,'a2':-0.0149,'a3':0.0563,'a4':-0.1160,'a5':-0.0114,'sigma':51},\
    'bmy':{'a0': 0.5515,'a1':0.9085,'a2':-0.1494,'a3':0.0616,'a4':-0.0668,'a5':-0.0083,'sigma':68},\
    'YVmVV':{'a0':0.3672,'a1':1.0467,'a2':-0.1995,'a3':0.0650,'a4':-0.0913,'a5':-0.0133,'sigma':78},\
    'VVmSV':{'a0':0.3481,'a1':1.1188,'a2':-0.2068,'a3':0.0299,'a4':-0.0481,'a5':-0.0083,'sigma':69},\
    'BGmVG':{'a0':0.6553,'a1':0.6278,'a2':-0.0629,'a3':0.0627,'a4':-0.0816,'a5':-0.0084,'sigma':45},\
    'BGmGG':{'a0':0.8492,'a1':0.4344,'a2':-0.0365,'a3':0.0466,'a4':-0.0696,'a5':-0.0107,'sigma':39},\
    'VmR':{'a0':0.3849,'a1':1.6205,'a2':-0.6395,'a3':0.1060,'a4':-0.0875,'a5':-0.0089,'sigma':41},\
    'VmI':{'a0':0.3575,'a1':0.9069,'a2':-0.2025,'a3':0.0395,'a4':-0.0551,'a5':-0.0061,'sigma':40},\
    'RmI':{'a0':0.4351,'a1':1.6549,'a2':-0.7215,'a3':-0.0610,'a4':0.0332,'a5':-0.0023,'sigma':62},\
    'BTmVT':{'a0':0.5726,'a1':0.4461,'a2':-0.0324,'a3':0.0518,'a4':-0.1170,'a5':-0.0094,'sigma':82},\
    'VmJ':{'a0':0.2943,'a1':0.5604,'a2':-0.0677,'a3':0.0179,'a4':-0.0532,'a5':-0.0088,'sigma':38},\
    'VmH':{'a0':0.4354,'a1':0.3405,'a2':-0.0263,'a3':-0.0012,'a4':-0.0049,'a5':-0.0027,'sigma':32},\
    'VmK':{'a0':0.4405,'a1':0.3272,'a2':-0.0252,'a3':-0.0016,'a4':-0.0053,'a5':-0.0040,'sigma':28},\
    'VTmK':{'a0':0.4813,'a1':0.2871,'a2':-0.0203,'a3':-0.0045,'a4':0.0062,'a5':-0.0019,'sigma':39}}

# R&M 2005 also use a polynomial correction, based on the metallicity range:
# We make a couple of assumptions on the format of Table 5:
#   First: All color indices have 4 metallicity ranges - 0.5>X>-0.5, -0.5>X>-1.5, -1.5>X>-2.5, -2.5>X>-4.0
#   Second: The coefficients for each range are in the order of X^0, X^1...
# Table 4 for dwarfs, Table 5 for giants

RamMelTable4 = {\
    'BmV':[[-261.548, 684.977, -470.049, 79.8977],[-324.033, 1516.44, -2107.37, 852.15],[30.5985, -46.7882],[139.965, -292.329]],\
    'bmy':[[-1237.11, 6591.29, -11061.3, 5852.18],[-2617.66, 22607.4, -68325.4, 86072.5, -38602.2],[103.927, -312.419, 225.43],[-294.106, 648.32]],\
    'YVmVV':[[-10407.1, 42733.6, -27378.8, -96466.3, 162033, -70956.4],[11.6451],[-507.732, 1943.73, -1727.66],[-310.166, 496.709]],\
    'VVmSV':[[-1436.48, 5566, -6780.53, 2613.4],[-728.818, 2256.18, -1704.54],[101.031, 114.354, -447.778],[596.461, -1130.92]],\
    'BGmVG':[[-439.817, 2637.06, -4762.8, 2606.79],[-257.527, 2078.96, -4919.04, 3685.65, -500.348],[-28.5544, 228.735, -295.958],[64.2911, -365.124]],\
    'BGmGG':[[-6.298, 160.976, -386.52, 250.628],[21.3254, -56.4562, -651.533, 720.639],[11.5114, -34.5752, -265.563],[-156.547, -313.408, 4886.53]],\
    'VmR':[[-2666.55, 27264.5, -103923, 174663, -104940, -23249.4, 32644.9],[4.20153],[123.94, -342.217],[8.55498]],\
    'VmI':[[-2757.79, 9961.33, -10546.6, -1746.05, 10512.3, -6653.57, 1301.21],[-22.9008, 40.2078],[-667.732, 1709.88, -1069.62],[-667.732, 1709.88, -1069.62]],\
    'RmI':[[-3326.97, 26263.8, -75355.8, 94246.5, -43334.8],[12.474],[-5837.31, 41439.2, -94729.8, 69584.8],[32.1826]],\
    'BTmVT':[[1199.21, -5470.57, 8367.46, -5119.55, 1078.09],[-64.1045, 140.575, -59.4233],[-6030.19, 29153.4, -25882.7, -64112.9, 126115, -59817.9],[-3255.07, 16259.9, -20315.3]],\
    'VmJ':[[422.406, -910.603, 621.335, -132.566],[-466.616, 658.349, -220.454],[-862.072, 1236.84, -423.729],[-1046.1, 1652.06, -597.34]],\
    'VmH':[[-53.5574, 36.099, 15.6878, -8.84468],[1.60629],[506.559, -1277.52, 939.519, -208.621],[-471.588, 643.972, -199.639]],\
    'VmK':[[-1425.36, 3218.36, -2566.54, 859.644, -102.554],[2.35133],[-1849.46, 4577, -4284.02, 1770.38, -268.589],[215.721, -796.519, 714.423, -175.678]],\
    'VTmK':[[-1581.85, 3273.1, -2395.38, 736.352, -80.8177],[68.1279, -130.968, 52.8391],[-2384.82, 4196.14, -2557.04, 595.365, -31.9955],[-628.682, 423.682]]}
    
RamMelTable5 = {\
    'BmV':[[112.116, -372.622, 67.1254, 395.333, -203.471],[-12.9762],[606.032, -1248.79, 627.453],[-9.26209]],\
    'bmy':[[-124.159, 553.827, -490.703],[888.088, -2879.23, 2097.89 ],[1867.63, -6657.49, 5784.81],[348.237, -659.093 ]],\
    'YVmVV':[[-308.851, 1241.57, -1524.60, 593.157],[-36.6533, 383.901, -458.085],[3038.83, -8668.15, 6067.04],[2685.88, -7433.07, 4991.81]],\
    'VVmSV':[[-1605.54, 9118.16, -17672.6, 14184.1, -4023.76],[187.841, -270.092],[10.1750],[-14.2019]],\
    'BGmVG':[[-15.0383, 50.8876, -32.3978],[80.1344, -147.055],[323.889, -1031.06, 795.024],[1403.86, -4866.09, 4029.75]],\
    'BGmGG':[[-0.52642, 10.4471, -7.53155],[26.1904, -89.2171],[9.87980],[232.248, -1452.43, 1848.07]],\
    'VmR':[[-8.51797, 15.6675],[-10.7764],[61.9821, -78.7382],[27.9886, -100.149 ]],\
    'VmI':[[0.42933],[-0.14180],[9.31011],[-23.0514]],\
    'RmI':[[61.3557, -116.711],[-16.8645],[32.0870],[-15.6318]],\
    'BTmVT':[[346.881, -1690.16, 2035.65, -797.248, 70.7799],[196.416, -372.164, 126.196],[938.789, -1919.98, 929.779],[1112.46, -2717.81, 1577.18]],\
    'VmJ':[[-122.595, 76.4847],[-10.3848],[4.18695, 13.8937],[-67.7716, 28.9202]],\
    'VmH':[[-377.022, 334.733, -69.8093],[71.7949, -55.5383, 9.61821],[-27.4190, 20.7082],[-46.2946, 20.1061]],\
    'VmK':[[-72.6664, 36.5361],[86.0358, -65.4928, 10.8901],[-6.96153, 14.3298],[-943.925, 1497.64, -795.867, 138.965]],\
    'VTmK':[[-37.2128, 31.2900, -6.72743],[-193.512, 166.183, -33.2781],[-2.02136],[8.06982]]}
 
RamMelDwarfRanges = {\
    'BmV':[[(-0.5, 0.5), (0.310, 1.507)],[(-1.5,-0.5), (0.307, 1.202)],[(-2.5, -1.5), (0.335, 1.030)],[(-4.0,-2.5), (0.343, 0.976)]],\
    'bmy':[[(-0.5, 0.5), (0.248, 0.824)],[(-1.5,-0.5), (0.234, 0.692)],[(-2.5, -1.5), (0.290, 0.672)],[(-4.0,-2.5), (0.270, 0.479)]],\
    'YVmVV':[[(-0.5, 0.5), (0.420, 0.940)],[(-1.5,-0.5), (0.452, 0.660)],[(-2.5, -1.5), (0.455, 0.720)],[(-4.0,-2.5), (0.446, 0.643)]],\
    'VVmSV':[[(-0.5, 0.5), (0.370, 1.130)],[(-1.5,-0.5), (0.410, 0.690)],[(-2.5, -1.5), (0.441, 0.810)],[(-4.0,-2.5), (0.438, 0.584)]],\
    'BGmVG':[[(-0.5, 0.5), (0.119, 0.936)],[(-1.5,-0.5), (0.132, 0.593)],[(-2.5, -1.5), (0.178, 0.621)],[(-4.0,-2.5), (0.185, 0.435)]],\
    'BGmGG':[[(-0.5, 0.5), (-0.271, 1.110)],[(-1.5,-0.5), (-0.262, 0.502)],[(-2.5, -1.5), (-0.200, 0.544)],[(-4.0,-2.5), (-0.179, 0.150)]],\
    'VmR':[[(-0.5, 0.5), (0.204, 0.880)],[(-1.5,-0.5), (0.284, 0.546)],[(-2.5, -1.5), (0.264, 0.532)],[(-4.0,-2.5), (0.240, 0.336)]],\
    'VmI':[[(-0.5, 0.5), (0.491, 1.721)],[(-1.5,-0.5), (0.597, 1.052)],[(-2.5, -1.5), (0.547, 1.026)],[(-4.0,-2.5), (0.000, 0.000)]],\
    'RmI':[[(-0.5, 0.5), (0.242, 0.838)],[(-1.5,-0.5), (0.300, 0.718)],[(-2.5, -1.5), (0.283, 0.551)],[(-4.0,-2.5), (0.290, 0.364)]],\
    'BTmVT':[[(-0.5, 0.5), (0.344, 1.715)],[(-1.5,-0.5), (0.391, 1.556)],[(-2.5, -1.5), (0.380, 0.922)],[(-4.0,-2.5), (0.367, 0.504)]],\
    'VmJ':[[(-0.5, 0.5), (0.815, 2.608)],[(-1.5,-0.5), (0.860, 2.087)],[(-2.5, -1.5), (0.927, 1.983)],[(-4.0,-2.5), (0.891, 1.932)]],\
    'VmH':[[(-0.5, 0.5), (0.834, 3.215)],[(-1.5,-0.5), (1.032, 2.532)],[(-2.5, -1.5), (1.070, 2.535)],[(-4.0,-2.5), (1.093, 2.388)]],\
    'VmK':[[(-0.5, 0.5), (0.896, 3.360)],[(-1.5,-0.5), (1.060, 2.665)],[(-2.5, -1.5), (1.101, 2.670)],[(-4.0,-2.5), (1.126, 2.596)]],\
    'VTmK':[[(-0.5, 0.5), (0.942, 3.284)],[(-1.5,-0.5), (1.078, 2.561)],[(-2.5, -1.5), (1.237, 2.406)],[(-4.0,-2.5), (1.170, 1.668)]]}
 
RamMelGiantRanges = {\
    'BmV':[[(-0.5, 0.5), (0.144, 1.668)],[(-1.5,-0.5), (0.664, 1.558)],[(-2.5, -1.5), (0.605, 1.352)],[(-4.0,-2.5), (0.680, 1.110)]],\
    'bmy':[[(-0.5, 0.5), (0.053, 1.077)],[(-1.5,-0.5), (0.309, 0.893)],[(-2.5, -1.5), (0.388, 0.702)],[(-4.0,-2.5), (0.404, 0.683)]],\
    'YVmVV':[[(-0.5, 0.5), (0.230, 1.290)],[(-1.5,-0.5), (0.558, 0.940)],[(-2.5, -1.5), (0.544, 0.817)],[(-4.0,-2.5), (0.510, 0.830)]],\
    'VVmSV':[[(-0.5, 0.5), (0.261, 1.230)],[(-1.5,-0.5), (0.508, 0.992)],[(-2.5, -1.5), (0.529, 0.990)],[(-4.0,-2.5), (0.573, 0.790)]],\
    'BGmVG':[[(-0.5, 0.5), (-0.079, 1.321)],[(-1.5,-0.5), (0.385, 1.021)],[(-2.5, -1.5), (0.307, 0.958)],[(-4.0,-2.5), (0.407, 0.648)]],\
    'BGmGG':[[(-0.5, 0.5), (-0.543, 1.230)],[(-1.5,-0.5), (0.155, 0.966)],[(-2.5, -1.5), (0.132, 0.991)],[(-4.0,-2.5), (0.104, 0.437)]],\
    'VmR':[[(-0.5, 0.5), (0.299, 1.106)],[(-1.5,-0.5), (0.387, 0.752)],[(-2.5, -1.5), (0.429, 0.598)],[(-4.0,-2.5), (0.394, 0.550)]],\
    'VmI':[[(-0.5, 0.5), (0.573, 2.000)],[(-1.5,-0.5), (0.795, 1.524)],[(-2.5, -1.5), (0.870, 1.303)],[(-4.0,-2.5), (0.812, 1.095)]],\
    'RmI':[[(-0.5, 0.5), (0.413, 0.793)],[(-1.5,-0.5), (0.383, 0.771)],[(-2.5, -1.5), (0.434, 0.725)],[(-4.0,-2.5), (0.364, 0.545)]],\
    'BTmVT':[[(-0.5, 0.5), (0.123, 1.953)],[(-1.5,-0.5), (0.424, 1.644)],[(-2.5, -1.5), (0.534, 1.356)],[(-4.0,-2.5), (0.465, 1.026)]],\
    'VmJ':[[(-0.5, 0.5), (1.259, 2.400)],[(-1.5,-0.5), (1.030, 3.418)],[(-2.5, -1.5), (1.033, 2.679)],[(-4.0,-2.5), (0.977, 2.048)]],\
    'VmH':[[(-0.5, 0.5), (1.194, 3.059)],[(-1.5,-0.5), (1.293, 4.263)],[(-2.5, -1.5), (1.273, 3.416)],[(-4.0,-2.5), (1.232, 2.625)]],\
    'VmK':[[(-0.5, 0.5), (1.244, 3.286)],[(-1.5,-0.5), (1.366, 4.474)],[(-2.5, -1.5), (1.334, 3.549)],[(-4.0,-2.5), (1.258, 2.768)]],\
    'VTmK':[[(-0.5, 0.5), (1.107, 3.944)],[(-1.5,-0.5), (1.403, 3.157)],[(-2.5, -1.5), (1.339, 3.750)],[(-4.0,-2.5), (1.668, 2.722)]]}
 
# We select the extinction curve relations as specified in 
# Rieke and Lebofsky 1985 (ApJ 288:618-621; January 15, 1985)
# The table values below are in the form X:E(X-V)/E(B-V), 
# for each filter/wavelength "X". Note the values for 'B' and 'V',
# are just for completeness. For Tycho ("xT"), Vilnius ("xV"), and 
# Geneva ("xG") filters, we use the extinction corrections for the 
# corresponding Johnson-Cousins filter. Stromgren 'b' is interpolated 
# between JC 'B' and 'V' bands. Stromgren 'y' uses JC 'V'. Note:
# only the JC band values should be "taken seriously". All others
# are approximate, and are only here as working values.
# 
RieLebTable3 = {\
    'U' : 1.64,\
    'UJ': 1.64,\
    'B' : 1.00,\
    'BG': 1.00,\
    'BT': 1.00,\
    'YV': 1.00,\
    'b' : 1.00,\
    'V' : 0.00,\
    'GG': 0.00,\
    'gS': 0.00,\
    'VG': 0.00,\
    'VT': 0.00,\
    'VV': 0.00,\
    'y' : 0.00,\
    'R' :-0.78,\
    'RJ':-0.78,\
    'rS':-0.78,\
    'SV':-0.78,\
    'I' :-1.60,\
    'IJ':-1.60,\
    'J' :-2.22,\
    'JJ':-2.22,\
    'H' :-2.55,\
    'HJ':-2.55,\
    'K' :-2.74,\
    'KJ':-2.74,\
    'L' :-2.91,\
    'M' :-3.02,\
    'N' :-2.93}
    
